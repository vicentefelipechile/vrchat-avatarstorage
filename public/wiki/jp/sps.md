# SPS (Super Plug Shader)

<span class="badge badge-purple">ERP</span> <span class="badge badge-red">NSFW</span>

## 概要
**SPS** (Super Plug Shader) は、**VRCFury** チームによって設計されたVRChat用の無料かつ最新のメッシュ変形システムです。通称「SSP」と呼ばれることもあります。**DPS** (Dynamic Penetration System) や **TPS** などの古い有料システムに取って代わるもので、他のアバターやオブジェクトと相互作用する際にアバターの一部をリアルに変形させることができます [1]。

## 何ができるの？
- **リアルな変形：** アバターのメッシュを変形させることで、挿入や物理的な接触をシミュレートします。
- **最適化：** 古いシステムよりもはるかに軽量で効率的です。
- **無料：** DPSとは異なり、SPSは完全に無料でオープンソースです。
- **互換性：** 最新のシェーダー（Poiyomi、LilToonなど）のほとんどで動作し、DPSやTPSを使用しているアバターとの後方互換性があります。

## 前提条件
始める前に、以下が揃っていることを確認してください：
- **Unity：** VRChat推奨バージョン。
- **VRChat SDK：** プロジェクトにインストール済み (VCC)。
- **VRCFury：** インストール済みで最新バージョンに更新済み [2]。
- **3Dモデル：** アニメーションさせたいメッシュ（穴または挿入物）を持つアバター。

## ステップバイステップ・インストールガイド

SPSは、Unity内のVRCFuryツールを通じて完全に管理されます。奇妙なシェーダーパッケージをインポートしたり、複雑な手動アニメーション設定を行ったりする必要はありません。

### ステップ1：VRCFuryのインストール
まだインストールしていない場合は、VRChat Creator Companion (VCC) からVRCFuryをインストールしてください。
1. VCCを開きます。
2. "Manage Project" に移動します。
3. パッケージリストで "VRCFury" を検索し、インストールをクリックします（表示されない場合はリポジトリを追加してください）。

### ステップ2：Socket (穴/ソケット) の作成
"Socket" は相互作用の受け手（口など）です。

1. **ツール：** Unityの上部バーで、`Tools` > `VRCFury` > `SPS` > `Create Socket` に移動します [1]。
2. **配置：** シーンに新しいオブジェクトが表示されます。
   - このオブジェクトをアバターのヒエラルキーにドラッグし、対応する**ボーンの子オブジェクト**にします（例：`Hip` または `Head`）。
3. **調整：** メッシュの穴の入り口に合わせてSocketオブジェクトを移動・回転させます。
   - ギズモの矢印は、穴の**内側**を指している必要があります。
   - Socketのタイプ（インスペクター内）が目的のもの（例：Vagina, Anal, Oral）と一致していることを確認してください。
4. **ライト：** IDライトを手動で設定する必要はありません。VRCFuryが代わりに行います。

> [!TIP]
> **配置に関する注意 (ERP)**
> ポイント (Socket) をアバターの奥深くに配置しすぎないでください。「穴」が深すぎると、快適にERPを行うことが難しくなります。入り口のすぐそば、または少し外側に配置することをお勧めします。
>
> **大きなプロポーションに注意：** アバターの腰が非常に広い場合や、お尻が非常に大きい場合（"巨大な尻"）、**Socketをさらに外側に移動してください**。そうしないと、相手が相互作用ポイントに「到達」する前に、ボディメッシュと衝突してしまいます。

### ステップ3：Plug (挿入部/プラグ) の作成
"Plug" は貫通して変形するオブジェクトです。

1. **メッシュの準備：**
   - 挿入物のメッシュが、Unityの静止位置で「真っ直ぐ」で「伸びている」ことを確認してください。SPSは全長を知る必要があります。
   - DPS/TPSから移行する場合は、古いスクリプトや特別なマテリアルを必ず削除してください。通常のシェーダー (Poiyomi) を使用してください [1]。
2. **ツール：** `Tools` > `VRCFury` > `SPS` > `Create Plug` に移動します [1]。
3. **配置：**
   - **オプションA（ボーンあり）：** ペニスにボーンがある場合は、Plugオブジェクトをドラッグして、ペニスの**ベースボーン**の子にします。
   - **オプションB（ボーンなし）：** メッシュ (mesh renderer) だけの場合は、Plugオブジェクトをドラッグして、**Mesh Renderer** を持つオブジェクトに直接ドロップします。
4. **設定：**
   - `VRCFury | SPS Plug` コンポーネントのインスペクターで、**Renderer** がペニスのメッシュであることを確認してください。
   - 向きを調整します：ギズモの湾曲部分は先端に、ベースは基部にある必要があります。
   - 適切な **Type** を設定します。

### ステップ4：Unityでのテスト
動作確認のためにアバターをアップロードする必要はありません。
1. VCCから **Gesture Manager** をインストールします [1]。
2. Unityで **Play Mode** に入ります。
3. Gesture Managerを選択します。
4. エミュレートされた表情メニューで、SPSオプションに移動します。
   - VRCFuryは、変形の有効化/無効化やテストを行うためのテストメニューを自動的に生成します。
   - ツールメニューから "Test Socket" を作成して、リアルタイムの相互作用をテストできます。

> [!WARNING]
> 警告：Constraints (制約)
> SPSが変形させるのと同じボーンでUnity Constraintsを使用することは避けてください。動きの競合 (ジッター) が発生する可能性があります [4]。

---

## 参考文献

[1] VRCFury. (n.d.). *SPS (Super Plug Shader)*. VRCFury Documentation. https://vrcfury.com/sps

[2] VRCFury. (n.d.). *Download & Install*. VRCFury Documentation. https://vrcfury.com/download

[3] VRCD. (n.d.). *SPS Tutorial*. VRCD. https://vrcd.org.cn

[4] VRCFury. (n.d.). *SPS Troubleshooting*. VRCFury Documentation. https://vrcfury.com/sps
